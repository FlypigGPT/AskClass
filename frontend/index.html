<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¯¾å ‚æŠ½é—®ç³»ç»Ÿ</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div id="app" class="container">
        <header>
            <h1>ğŸ“ è¯¾å ‚æŠ½é—®ç³»ç»Ÿ</h1>
            <p class="subtitle">Classroom Q&A System</p>
        </header>

        <main>
            <!-- æŠ½é—®åŒºåŸŸ -->
            <section class="random-section">
                <h2>éšæœºæŠ½é—®</h2>
                <div class="random-card">
                    <div class="student-display">
                        <div v-if="!selectedStudent" class="student-name">ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®å¼€å§‹æŠ½é—®</div>
                        <template v-else>
                            <div class="student-name">{{ selectedStudent.name }}</div>
                            <div class="student-info">
                                å­¦å·: {{ selectedStudent.student_id }} | ç­çº§: {{ selectedStudent.class_name || 'æœªè®¾ç½®' }}
                            </div>
                        </template>
                    </div>
                    <button @click="randomSelectStudent" :disabled="isRandoming" class="btn btn-primary btn-large">
                        {{ isRandoming ? 'æŠ½å–ä¸­...' : 'ğŸ² éšæœºæŠ½å–å­¦ç”Ÿ' }}
                    </button>
                    <div v-if="selectedStudent" class="record-area">
                        <input v-model="questionInput" type="text" placeholder="è¾“å…¥æé—®çš„é—®é¢˜ï¼ˆå¯é€‰ï¼‰" class="input-field">
                        <select v-model="qualitySelect" class="select-field">
                            <option value="">å›ç­”è´¨é‡ï¼ˆå¯é€‰ï¼‰</option>
                            <option value="5">ä¼˜ç§€ â­â­â­â­â­</option>
                            <option value="4">è‰¯å¥½ â­â­â­â­</option>
                            <option value="3">ä¸­ç­‰ â­â­â­</option>
                            <option value="2">ä¸€èˆ¬ â­â­</option>
                            <option value="1">è¾ƒå·® â­</option>
                        </select>
                        <button @click="saveRecord" class="btn btn-success">ğŸ’¾ ä¿å­˜è®°å½•</button>
                    </div>
                </div>
            </section>

            <!-- å­¦ç”Ÿç®¡ç† -->
            <section class="students-section">
                <div class="section-header">
                    <h2>å­¦ç”Ÿç®¡ç†</h2>
                    <button @click="showAddForm = !showAddForm" class="btn btn-secondary">
                        {{ showAddForm ? 'âŒ å–æ¶ˆ' : 'â• æ·»åŠ å­¦ç”Ÿ' }}
                    </button>
                </div>
                
                <!-- æ·»åŠ å­¦ç”Ÿè¡¨å• -->
                <div v-if="showAddForm" class="form-card">
                    <h3>æ·»åŠ æ–°å­¦ç”Ÿ</h3>
                    <input v-model="newStudent.name" type="text" placeholder="å§“å" class="input-field" required>
                    <input v-model="newStudent.student_id" type="text" placeholder="å­¦å·" class="input-field" required>
                    <input v-model="newStudent.class_name" type="text" placeholder="ç­çº§" class="input-field">
                    <div class="form-actions">
                        <button @click="addStudent" class="btn btn-success">âœ… ç¡®è®¤æ·»åŠ </button>
                        <button @click="cancelAdd" class="btn btn-danger">âŒ å–æ¶ˆ</button>
                    </div>
                </div>

                <!-- å­¦ç”Ÿåˆ—è¡¨ -->
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>å§“å</th>
                                <th>å­¦å·</th>
                                <th>ç­çº§</th>
                                <th>æ·»åŠ æ—¶é—´</th>
                                <th>æ“ä½œ</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr v-if="students.length === 0">
                                <td colspan="5" class="empty-state">æš‚æ— å­¦ç”Ÿæ•°æ®</td>
                            </tr>
                            <tr v-for="student in students" :key="student.id">
                                <td>{{ student.name }}</td>
                                <td>{{ student.student_id }}</td>
                                <td>{{ student.class_name || '-' }}</td>
                                <td>{{ formatDateTime(student.created_at) }}</td>
                                <td>
                                    <button @click="deleteStudent(student.id)" class="btn btn-danger btn-small">
                                        ğŸ—‘ï¸ åˆ é™¤
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- æŠ½é—®å†å² -->
            <section class="history-section">
                <div class="section-header">
                    <h2>æŠ½é—®å†å²</h2>
                    <button @click="loadHistory" class="btn btn-secondary">ğŸ”„ åˆ·æ–°</button>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>å­¦ç”Ÿå§“å</th>
                                <th>å­¦å·</th>
                                <th>é—®é¢˜</th>
                                <th>å›ç­”è´¨é‡</th>
                                <th>æ—¶é—´</th>
                                <th>æ“ä½œ</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr v-if="history.length === 0">
                                <td colspan="6" class="empty-state">æš‚æ— æŠ½é—®è®°å½•</td>
                            </tr>
                            <tr v-for="record in history" :key="record.id">
                                <td>{{ record.name }}</td>
                                <td>{{ record.student_id }}</td>
                                <td>{{ record.question || '-' }}</td>
                                <td v-html="formatQuality(record.answer_quality)"></td>
                                <td>{{ formatDateTime(record.created_at) }}</td>
                                <td>
                                    <button @click="deleteHistory(record.id)" class="btn btn-danger btn-small">
                                        ğŸ—‘ï¸ åˆ é™¤
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>
        </main>

        <footer>
            <p>Â© 2025 è¯¾å ‚æŠ½é—®ç³»ç»Ÿ | Made with â¤ï¸ & Vue.js</p>
        </footer>
    </div>

    <!-- å¼•å…¥ Vue 3 -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
